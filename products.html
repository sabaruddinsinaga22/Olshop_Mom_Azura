<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produk - Toko Online</title>

    <!-- Bootstrap 5.3.8 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .product-img {
            height: 220px;
            object-fit: cover;
        }
    </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container">
        <a class="navbar-brand fw-bold" href="index.html">Toko Online</a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMenu">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarMenu">
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="index.html">Dashboard</a>
                <a class="nav-link" href="about.html">Tentang Kami</a>
                <a class="nav-link active" href="products.html">Produk</a>
                <a class="nav-link" href="cart.html">
                    Keranjang (<span id="cart-count">0</span>)
                </a>
                <a class="nav-link" href="contact.html">Kontak</a>
            </div>
        </div>
    </div>
</nav>

<!-- Produk -->
<div class="container mt-5">
    <h1 class="fw-bold text-center mb-4">Produk Kami</h1>
    <div id="product-list" class="row"></div>
</div>

<script>
const PHONE_NUMBER = "6282360594070";

// Format Rupiah
function formatRupiah(angka) {
    return new Intl.NumberFormat("id-ID").format(angka);
}

// Load Produk
function loadProducts() {
    const products = JSON.parse(localStorage.getItem('products')) || [];
    const list = document.getElementById('product-list');
    list.innerHTML = '';

    if (products.length === 0) {
        list.innerHTML = `
            <div class="col-12">
                <div class="alert alert-warning text-center">
                    Belum ada produk tersedia.
                </div>
            </div>
        `;
        return;
    }

    products.forEach(product => {
        list.innerHTML += `
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm">
                    <img src="${product.image}" class="card-img-top product-img" alt="${product.name}">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">${product.name}</h5>
                        <p class="card-text">${product.description}</p>
                        <p class="fw-bold text-primary">
                            Rp ${formatRupiah(product.price)}
                        </p>

                        <button class="btn btn-warning mb-2"
                            onclick="addToCart(${product.id}, '${product.name}', ${product.price})">
                            Tambah ke Keranjang
                        </button>

                        <button class="btn btn-success"
                            onclick="pesanLangsung('${product.name}', ${product.price})">
                            Pesan Langsung
                        </button>
                    </div>
                </div>
            </div>
        `;
    });
}

// Tambah ke Keranjang
function addToCart(id, name, price) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    const existing = cart.find(item => item.id === id);

    if (existing) {
        existing.quantity += 1;
    } else {
        cart.push({
            id: id,
            name: name,
            price: price,
            quantity: 1
        });
    }

    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    alert('Produk ditambahkan ke keranjang!');
}

// Pesan Langsung WhatsApp
function pesanLangsung(nama, harga) {
    const message = `Halo Admin Toko Online,

Saya ingin memesan produk berikut:

Produk: ${nama}
Harga: Rp ${formatRupiah(harga)}
Jumlah: 1

Terima kasih.`;

    const url = `https://wa.me/${PHONE_NUMBER}?text=${encodeURIComponent(message)}`;
    window.open(url, "_blank");
}

// Update Counter Keranjang
function updateCartCount() {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const total = cart.reduce((sum, item) => sum + item.quantity, 0);
    document.getElementById('cart-count').textContent = total;
}

// Jalankan Saat Halaman Dibuka
loadProducts();
updateCartCount();
</script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
